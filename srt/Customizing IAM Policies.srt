1
00:00:00,130 --> 00:00:02,340
Customizing IAM Policies.

2
00:00:03,380 --> 00:00:06,240
Let's review the components of an IAM policy.

3
00:00:06,900 --> 00:00:11,210
Permissions are granted to IAM entities including IAM users,

4
00:00:11,220 --> 00:00:14,020
federated users, groups, and roles.

5
00:00:14,680 --> 00:00:17,590
To give entities permissions, you can attach a policy.

6
00:00:17,680 --> 00:00:20,360
A policy consists of one or more statements,

7
00:00:20,400 --> 00:00:23,200
each of which describes one set of permissions.

8
00:00:23,200 --> 00:00:23,220
Version. Specify the version of the policy language that you want to use.
each of which describes one set of permissions.

9
00:00:23,220 --> 00:00:28,010
Version. Specify the version of the policy language that you want to use.

10
00:00:28,870 --> 00:00:30,280
Sid is optional

11
00:00:30,720 --> 00:00:34,770
and specifies the statement ID to differentiate between your statements.

12
00:00:35,380 --> 00:00:41,370
Effect. Specify whether to allow or deny access because access is denied by default.

13
00:00:41,450 --> 00:00:44,730
You typically write policies where the effect is to allow.

14
00:00:44,980 --> 00:00:47,440
Principal specifies the IAM entity

15
00:00:47,570 --> 00:00:50,110
that is allowed or denied access to a resource

16
00:00:50,250 --> 00:00:51,670
and is usually implied.

17
00:00:52,560 --> 00:00:54,950
Action includes a list of actions

18
00:00:55,060 --> 00:00:56,400
that you allow or deny.

19
00:00:57,200 --> 00:00:58,330
Resources

20
00:00:58,730 --> 00:00:59,750
specify which

21
00:00:59,760 --> 00:01:02,190
AWS resources you allow the action on.

22
00:01:02,990 --> 00:01:06,300
Conditions. Specify which conditions must be present

23
00:01:06,410 --> 00:01:08,000
for the policy to take effect.

24
00:01:09,100 --> 00:01:13,590
Now let's look at some examples of how you can customize your IAM policies.

25
00:01:13,640 --> 00:01:18,660
Let's start with an initial policy that allows the ability to start an EC2 instance.

26
00:01:19,580 --> 00:01:20,850
The effect is allow,

27
00:01:21,300 --> 00:01:22,860
the principle is set to anyone.

28
00:01:23,250 --> 00:01:26,410
The action is the permission to start EC2 instances.

29
00:01:26,860 --> 00:01:29,680
This permission applies to any instance in any region.

30
00:01:30,150 --> 00:01:33,840
If you wanted to restrict the capability to a single EC2 instance,

31
00:01:33,860 --> 00:01:37,240
you can add an Amazon resource name, or ARN,

32
00:01:37,390 --> 00:01:38,230
to the policy.

33
00:01:38,780 --> 00:01:42,610
Adding a resource entry limits the permissions to only the resource listed.

34
00:01:42,920 --> 00:01:46,080
You can also restrict permissions only to specific regions

35
00:01:46,080 --> 00:01:47,690
by adding a policy condition.

36
00:01:49,400 --> 00:01:52,640
You can list more than one policy condition in a single policy,

37
00:01:52,760 --> 00:01:56,460
but all policy conditions must be true for the policy to take effect.

38
00:01:56,740 --> 00:01:59,700
If the policy holder attempts to start an instance in any

39
00:01:59,700 --> 00:02:02,190
other domain other than the one listed in the condition,

40
00:02:02,360 --> 00:02:03,670
the action will be denied.

41
00:02:04,930 --> 00:02:09,199
You may want to use a deny policy to explicitly protect certain resources.

42
00:02:09,600 --> 00:02:11,130
The effect is set to deny.

43
00:02:11,430 --> 00:02:12,360
By itself,

44
00:02:12,480 --> 00:02:16,160
this deny would block the principal from stopping any EC2 instance.

45
00:02:16,390 --> 00:02:19,940
By adding a condition listing a specific range of IP addresses,

46
00:02:20,080 --> 00:02:22,710
this policy denies the ability to stop any instance

47
00:02:22,710 --> 00:02:25,020
only within the address listed in the condition.

48
00:02:26,290 --> 00:02:30,360
Security principals, such as users, can be assigned multiple IAM policies.

49
00:02:30,640 --> 00:02:33,340
When multiple policies are assigned, all apply to

50
00:02:33,340 --> 00:02:35,380
the principal, and the permissions are additive.

51
00:02:35,670 --> 00:02:40,780
These two policies in combination allow the user to both start and stop EC2 instances.

52
00:02:41,120 --> 00:02:41,940
Conversely,

53
00:02:42,080 --> 00:02:45,820
it is possible that a principal is assigned multiple policies that conflict,

54
00:02:45,840 --> 00:02:49,980
where one policy allows a specific action while the other denies the same action.

55
00:02:50,295 --> 00:02:54,645
In any conflict between allow and deny permissions, deny always wins.

56
00:02:54,995 --> 00:02:59,355
In this case, the principal would be denied the ability to start an EC2 instance.

57
00:03:01,140 --> 00:03:05,920
Let's look at an example of an IAM policy which only allows a user to start or stop

58
00:03:06,030 --> 00:03:08,190
EC2 instances in a single region.

59
00:03:09,280 --> 00:03:11,840
VisualEditor0 in the Sid element means

60
00:03:11,840 --> 00:03:16,420
this policy was created using the visual editor in the AWS console.

61
00:03:17,210 --> 00:03:19,380
The Effect element states the user, or role,

62
00:03:19,380 --> 00:03:23,160
this policy is attached to will be allowed to perform the specified actions.

63
00:03:24,120 --> 00:03:25,640
There is no Principal element

64
00:03:25,640 --> 00:03:29,670
since the principal will be the IAM user, or role, the policy is attached to.

65
00:03:30,120 --> 00:03:33,620
The Principal element is only used for resource-based policies.

66
00:03:34,590 --> 00:03:37,280
The Action element states the user can start or stop

67
00:03:37,280 --> 00:03:38,810
EC2 instances.

68
00:03:39,670 --> 00:03:42,360
The wildcard in the Resources element means the allow

69
00:03:42,360 --> 00:03:44,860
effect will apply to all resources in the account

70
00:03:44,860 --> 00:03:48,420
as long as there are no other similar policies with deny actions.

71
00:03:49,150 --> 00:03:51,780
The Condition element states that this policy should only

72
00:03:51,780 --> 00:03:54,280
allow the actions in the us-east-1 region.

